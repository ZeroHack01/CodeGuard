<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CodeGuard - Static Code Security Analysis Platform</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600;700&family=Inter:wght@300;400;500;600;700;800&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            /* CodeGuard Brand Colors */
            --primary: #00D9FF;
            --secondary: #00FF88;
            --accent: #FF3366;
            --purple: #6366f1;
            --purple-dark: #4f46e5;
            
            /* Enterprise Colors */
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
            --info: #06b6d4;
            
            /* Dark Theme */
            --dark: #0a0a23;
            --dark-card: #1a1a2e;
            --dark-surface: #16213e;
            --gray: #64748b;
            --gray-light: #94a3b8;
            --gray-lighter: #cbd5e1;
            --white: #ffffff;
            
            /* Gradients */
            --bg-gradient: linear-gradient(135deg, var(--dark) 0%, var(--dark-card) 50%, var(--dark-surface) 100%);
            --brand-gradient: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 50%, var(--accent) 100%);
            --enterprise-gradient: linear-gradient(135deg, var(--purple) 0%, var(--purple-dark) 100%);
        }

        body {
            font-family: 'Inter', sans-serif;
            background: var(--bg-gradient);
            color: var(--white);
            line-height: 1.6;
            min-height: 100vh;
            position: relative;
            overflow-x: hidden;
        }

        /* Floating Particles */
        .particle {
            position: fixed;
            pointer-events: none;
            z-index: 1;
            border-radius: 50%;
            animation: float 8s infinite linear;
        }

        .particle.primary { background: rgba(0, 217, 255, 0.3); }
        .particle.secondary { background: rgba(0, 255, 136, 0.3); }
        .particle.accent { background: rgba(255, 51, 102, 0.3); }

        @keyframes float {
            0% { transform: translateY(100vh) rotate(0deg) scale(0); opacity: 0; }
            10% { opacity: 1; transform: scale(1); }
            90% { opacity: 1; }
            100% { transform: translateY(-100px) rotate(360deg) scale(0); opacity: 0; }
        }

        /* Header */
        .header {
            background: rgba(10, 10, 35, 0.95);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid rgba(0, 217, 255, 0.2);
            padding: 1rem 0;
            position: sticky;
            top: 0;
            z-index: 1000;
            box-shadow: 0 8px 32px rgba(0, 217, 255, 0.1);
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 2rem;
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 1rem;
            text-decoration: none;
            transition: transform 0.3s ease;
        }

        .logo:hover {
            transform: scale(1.05);
        }

        .logo-icon {
            width: 50px;
            height: 50px;
            background: var(--brand-gradient);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.8rem;
            box-shadow: 0 8px 25px rgba(0, 217, 255, 0.4);
            animation: pulse 3s ease-in-out infinite;
            font-family: 'JetBrains Mono', monospace;
            font-weight: bold;
            color: var(--white);
        }

        @keyframes pulse {
            0%, 100% { box-shadow: 0 8px 25px rgba(0, 217, 255, 0.4); }
            50% { box-shadow: 0 8px 25px rgba(0, 255, 136, 0.4); }
        }

        .logo-text {
            font-family: 'JetBrains Mono', monospace;
            font-size: 1.8rem;
            font-weight: 800;
            background: var(--brand-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            letter-spacing: -0.02em;
        }

        .nav-stats {
            display: flex;
            gap: 2rem;
            align-items: center;
        }

        .stat-item {
            text-align: center;
            padding: 0.5rem 1rem;
            background: rgba(0, 217, 255, 0.1);
            border: 1px solid rgba(0, 217, 255, 0.2);
            border-radius: 8px;
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
        }

        .stat-item:hover {
            background: rgba(0, 217, 255, 0.2);
            transform: translateY(-2px);
        }

        .stat-number {
            display: block;
            font-size: 1.2rem;
            font-weight: bold;
            color: var(--primary);
            font-family: 'JetBrains Mono', monospace;
        }

        .stat-label {
            font-size: 0.8rem;
            color: var(--gray-light);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        /* Navigation */
        .nav {
            display: flex;
            gap: 2rem;
            margin-right: 2rem;
        }

        .nav-item {
            color: var(--gray-light);
            text-decoration: none;
            font-weight: 500;
            padding: 0.75rem 1rem;
            border-radius: 8px;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .nav-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: var(--brand-gradient);
            opacity: 0.1;
            transition: left 0.3s ease;
        }

        .nav-item:hover::before {
            left: 0;
        }

        .nav-item:hover {
            color: var(--primary);
            background: rgba(0, 217, 255, 0.1);
        }

        /* Hero Section */
        .hero {
            text-align: center;
            padding: 4rem 0;
            position: relative;
        }

        .hero-badge {
            display: inline-flex;
            align-items: center;
            gap: 0.75rem;
            background: rgba(0, 217, 255, 0.15);
            border: 1px solid rgba(0, 217, 255, 0.3);
            border-radius: 50px;
            padding: 0.75rem 1.5rem;
            font-size: 1rem;
            font-weight: 600;
            color: var(--primary);
            margin-bottom: 2rem;
            backdrop-filter: blur(10px);
        }

        .bug-icon {
            font-size: 1.8rem;
            animation: bugRun 4s ease-in-out infinite;
            display: inline-block;
        }

        @keyframes bugRun {
            0% { transform: translateX(0px) rotate(0deg); }
            25% { transform: translateX(10px) rotate(-5deg); }
            50% { transform: translateX(20px) rotate(5deg); }
            75% { transform: translateX(10px) rotate(-5deg); }
            100% { transform: translateX(0px) rotate(0deg); }
        }

        .hero-title {
            font-size: 4rem;
            font-weight: 800;
            margin-bottom: 1.5rem;
            background: var(--brand-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            line-height: 1.1;
            text-shadow: 0 0 50px rgba(0, 217, 255, 0.3);
        }

        .hero-subtitle {
            font-size: 1.3rem;
            color: var(--gray-light);
            max-width: 700px;
            margin: 0 auto 3rem;
        }

        .hero-actions {
            display: flex;
            gap: 1.5rem;
            justify-content: center;
            flex-wrap: wrap;
        }

        .btn {
            padding: 1rem 2rem;
            border-radius: 12px;
            font-weight: 600;
            text-decoration: none;
            transition: all 0.3s ease;
            border: none;
            cursor: pointer;
            font-family: inherit;
            font-size: 1rem;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            position: relative;
            overflow: hidden;
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.6s ease;
        }

        .btn:hover::before {
            left: 100%;
        }

        .btn-primary {
            background: var(--brand-gradient);
            color: var(--white);
            box-shadow: 0 8px 25px rgba(0, 217, 255, 0.4);
        }

        .btn-primary:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 35px rgba(0, 217, 255, 0.5);
        }

        .btn-secondary {
            background: var(--enterprise-gradient);
            color: var(--white);
            box-shadow: 0 8px 25px rgba(99, 102, 241, 0.4);
        }

        .btn-secondary:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 35px rgba(99, 102, 241, 0.5);
        }

        /* Analysis Platform */
        .analysis-platform {
            background: rgba(26, 26, 46, 0.8);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(0, 217, 255, 0.2);
            border-radius: 20px;
            padding: 3rem;
            margin: 4rem 0;
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.3);
            position: relative;
            overflow: hidden;
        }

        .analysis-platform::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: conic-gradient(from 0deg, transparent, rgba(0, 217, 255, 0.05), transparent);
            animation: rotate 10s linear infinite;
        }

        @keyframes rotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        .platform-content {
            position: relative;
            z-index: 2;
        }

        .platform-header {
            text-align: center;
            margin-bottom: 3rem;
        }

        .platform-title {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 1rem;
            background: var(--brand-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .platform-subtitle {
            font-size: 1.1rem;
            color: var(--gray-light);
            max-width: 600px;
            margin: 0 auto;
        }

        .upload-zone {
            border: 2px dashed rgba(0, 217, 255, 0.4);
            border-radius: 16px;
            padding: 4rem 2rem;
            text-align: center;
            background: rgba(10, 10, 35, 0.4);
            transition: all 0.3s ease;
            cursor: pointer;
            margin-bottom: 2rem;
            position: relative;
            overflow: hidden;
        }

        .upload-zone::after {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(0, 217, 255, 0.1), transparent);
            transition: left 0.8s ease;
        }

        .upload-zone:hover::after {
            left: 100%;
        }

        .upload-zone:hover {
            border-color: var(--primary);
            background: rgba(0, 217, 255, 0.05);
            transform: scale(1.02);
            box-shadow: 0 15px 35px rgba(0, 217, 255, 0.2);
        }

        .upload-zone.active {
            border-color: var(--secondary);
            background: rgba(0, 255, 136, 0.05);
        }

        .upload-content {
            position: relative;
            z-index: 2;
        }

        .upload-icon {
            font-size: 4rem;
            margin-bottom: 1.5rem;
            display: block;
            font-family: 'JetBrains Mono', monospace;
            font-weight: 600;
            color: var(--primary);
            text-shadow: 0 0 20px rgba(0, 217, 255, 0.4);
        }

        .upload-text {
            font-size: 1.3rem;
            font-weight: 600;
            color: var(--white);
            margin-bottom: 0.75rem;
        }

        .upload-subtext {
            color: var(--gray-light);
            font-size: 1rem;
        }

        /* Analysis Controls */
        .analysis-controls {
            display: grid;
            grid-template-columns: 1fr auto auto;
            gap: 1.5rem;
            align-items: center;
            margin-bottom: 2rem;
        }

        .language-select {
            background: rgba(26, 26, 46, 0.8);
            border: 1px solid rgba(0, 217, 255, 0.3);
            border-radius: 10px;
            padding: 1rem 1.5rem;
            color: var(--white);
            font-family: inherit;
            font-size: 1rem;
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
        }

        .language-select:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(0, 217, 255, 0.1);
        }

        .analyze-btn {
            background: var(--brand-gradient);
            color: var(--white);
            padding: 1rem 2.5rem;
            border: none;
            border-radius: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.75rem;
            font-size: 1.1rem;
            box-shadow: 0 8px 25px rgba(0, 217, 255, 0.3);
            position: relative;
            overflow: hidden;
        }

        .analyze-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 35px rgba(0, 217, 255, 0.4);
        }

        .analyze-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .export-btn {
            background: var(--enterprise-gradient);
            color: var(--white);
            padding: 1rem 2rem;
            border: none;
            border-radius: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 1rem;
            box-shadow: 0 8px 25px rgba(99, 102, 241, 0.3);
        }

        .export-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 35px rgba(99, 102, 241, 0.4);
        }

        /* Progress Section */
        .progress-section {
            display: none;
            text-align: center;
            padding: 2rem;
            background: rgba(10, 10, 35, 0.6);
            border-radius: 12px;
            margin: 2rem 0;
            backdrop-filter: blur(10px);
        }

        .progress-section.active {
            display: block;
        }

        .progress-bar {
            width: 100%;
            height: 12px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 6px;
            overflow: hidden;
            margin: 1rem 0;
            position: relative;
        }

        .progress-fill {
            height: 100%;
            background: var(--brand-gradient);
            width: 0%;
            border-radius: 6px;
            transition: width 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .progress-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            animation: shimmer 2s infinite;
        }

        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        .progress-text {
            color: var(--primary);
            font-weight: 600;
            font-family: 'JetBrains Mono', monospace;
        }

        /* Results Panel */
        .results-panel {
            background: rgba(10, 10, 35, 0.8);
            border: 1px solid rgba(0, 217, 255, 0.2);
            border-radius: 16px;
            padding: 2.5rem;
            margin-top: 2rem;
            display: none;
            backdrop-filter: blur(20px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
        }

        .results-panel.active {
            display: block;
            animation: slideUp 0.5s ease-out;
        }

        @keyframes slideUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .results-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .results-title {
            font-size: 1.5rem;
            font-weight: 700;
            background: var(--brand-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .severity-filter {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
        }

        .filter-btn {
            padding: 0.5rem 1rem;
            border: 1px solid rgba(255, 255, 255, 0.2);
            background: rgba(255, 255, 255, 0.05);
            color: white;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.8rem;
            font-weight: 500;
        }

        .filter-btn.active {
            background: var(--brand-gradient);
            border-color: transparent;
            box-shadow: 0 4px 15px rgba(0, 217, 255, 0.3);
        }

        .filter-btn:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: translateY(-1px);
        }

        .results-summary {
            display: flex;
            gap: 1.5rem;
            flex-wrap: wrap;
            margin-bottom: 2rem;
        }

        .summary-badge {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.75rem 1.25rem;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 600;
            backdrop-filter: blur(10px);
        }

        .summary-critical {
            background: rgba(239, 68, 68, 0.15);
            color: var(--danger);
            border: 1px solid rgba(239, 68, 68, 0.3);
        }

        .summary-warning {
            background: rgba(245, 158, 11, 0.15);
            color: var(--warning);
            border: 1px solid rgba(245, 158, 11, 0.3);
        }

        .summary-info {
            background: rgba(0, 217, 255, 0.15);
            color: var(--primary);
            border: 1px solid rgba(0, 217, 255, 0.3);
        }

        .vulnerability-item {
            background: rgba(26, 26, 46, 0.6);
            border-radius: 12px;
            padding: 1.5rem;
            margin-bottom: 1rem;
            border-left: 4px solid;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }

        .vulnerability-item:hover {
            transform: translateX(5px);
            background: rgba(26, 26, 46, 0.8);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
        }

        .vulnerability-item.critical {
            border-left-color: var(--danger);
        }

        .vulnerability-item.warning {
            border-left-color: var(--warning);
        }

        .vulnerability-item.info {
            border-left-color: var(--primary);
        }

        .vuln-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 1rem;
        }

        .vuln-title-section {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .vuln-icon {
            font-size: 1.2rem;
        }

        .vuln-title {
            font-weight: 600;
            font-size: 1.1rem;
            color: var(--white);
        }

        .vuln-severity {
            padding: 0.3rem 0.8rem;
            border-radius: 15px;
            font-size: 0.8rem;
            font-weight: 600;
            text-transform: uppercase;
        }

        .severity-critical {
            background: rgba(239, 68, 68, 0.2);
            color: var(--danger);
        }

        .severity-warning {
            background: rgba(245, 158, 11, 0.2);
            color: var(--warning);
        }

        .severity-info {
            background: rgba(0, 217, 255, 0.2);
            color: var(--primary);
        }

        .vuln-location {
            color: var(--gray-light);
            font-size: 0.9rem;
            margin-bottom: 1rem;
            font-family: 'JetBrains Mono', monospace;
        }

        .vuln-description {
            color: var(--gray-light);
            margin-bottom: 1rem;
            line-height: 1.5;
        }

        .vuln-code {
            background: rgba(0, 0, 0, 0.6);
            border: 1px solid rgba(0, 217, 255, 0.2);
            border-radius: 8px;
            padding: 1rem;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.9rem;
            color: var(--gray-lighter);
            overflow-x: auto;
            position: relative;
        }

        .vuln-code::before {
            content: attr(data-language);
            position: absolute;
            top: 0.5rem;
            right: 0.5rem;
            font-size: 0.7rem;
            color: var(--primary);
            background: rgba(0, 217, 255, 0.1);
            padding: 0.2rem 0.5rem;
            border-radius: 4px;
        }

        .vulnerable-code {
            background: rgba(255, 51, 102, 0.2);
            color: var(--accent);
            padding: 0.2rem 0.4rem;
            border-radius: 3px;
        }

        .recommendation {
            background: rgba(0, 255, 136, 0.1);
            border-left: 3px solid var(--secondary);
            padding: 1rem;
            border-radius: 0 8px 8px 0;
            margin-top: 1rem;
        }

        .recommendation-title {
            color: var(--secondary);
            font-weight: 600;
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        /* Sidebar */
        .sidebar {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
            position: sticky;
            top: 100px;
        }

        .sidebar-card {
            background: rgba(26, 26, 46, 0.6);
            border: 1px solid rgba(0, 217, 255, 0.2);
            border-radius: 16px;
            padding: 1.5rem;
            backdrop-filter: blur(20px);
            transition: all 0.3s ease;
        }

        .sidebar-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 15px 30px rgba(0, 217, 255, 0.1);
        }

        .sidebar-card h3 {
            color: var(--primary);
            margin-bottom: 1rem;
            font-size: 1.1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .live-stats {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
        }

        .live-stat {
            text-align: center;
            padding: 1rem;
            background: rgba(0, 217, 255, 0.1);
            border-radius: 8px;
            border: 1px solid rgba(0, 217, 255, 0.2);
        }

        .live-stat-value {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--primary);
            font-family: 'JetBrains Mono', monospace;
        }

        .live-stat-label {
            font-size: 0.8rem;
            color: var(--gray-light);
            margin-top: 0.3rem;
        }

        .language-list {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
        }

        .language-tag {
            background: rgba(0, 217, 255, 0.2);
            border: 1px solid rgba(0, 217, 255, 0.3);
            border-radius: 15px;
            padding: 0.4rem 0.8rem;
            font-size: 0.8rem;
            color: var(--primary);
            transition: all 0.3s ease;
        }

        .language-tag:hover {
            background: rgba(0, 217, 255, 0.3);
            transform: scale(1.05);
        }

        /* Features Section */
        .features-section {
            margin: 6rem 0;
        }

        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(380px, 1fr));
            gap: 2rem;
            margin-top: 3rem;
        }

        .feature-card {
            background: rgba(26, 26, 46, 0.6);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(0, 217, 255, 0.2);
            border-radius: 16px;
            padding: 2.5rem;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .feature-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(0, 217, 255, 0.1), transparent);
            transition: left 0.6s ease;
        }

        .feature-card:hover::before {
            left: 100%;
        }

        .feature-card:hover {
            transform: translateY(-5px);
            border-color: var(--primary);
            box-shadow: 0 20px 40px rgba(0, 217, 255, 0.2);
        }

        .feature-icon {
            width: 60px;
            height: 60px;
            background: var(--brand-gradient);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            margin-bottom: 1.5rem;
            position: relative;
            z-index: 2;
            box-shadow: 0 8px 20px rgba(0, 217, 255, 0.3);
        }

        .feature-title {
            font-size: 1.4rem;
            font-weight: 600;
            margin-bottom: 1rem;
            color: var(--white);
            position: relative;
            z-index: 2;
        }

        .feature-description {
            color: var(--gray-light);
            line-height: 1.6;
            position: relative;
            z-index: 2;
        }

        /* Main Grid Layout */
        .main-grid {
            display: grid;
            grid-template-columns: 1fr 350px;
            gap: 2rem;
            margin-bottom: 3rem;
        }

        /* Export Section */
        .export-section {
            margin-top: 2rem;
            text-align: center;
            display: none;
        }

        .export-section.active {
            display: block;
        }

        .export-buttons {
            display: flex;
            gap: 1rem;
            justify-content: center;
            flex-wrap: wrap;
        }

        /* Statistics Section */
        .stats-section {
            background: rgba(26, 26, 46, 0.8);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(0, 217, 255, 0.2);
            border-radius: 20px;
            padding: 4rem 2rem;
            margin: 6rem 0;
            text-align: center;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 3rem;
            margin-top: 3rem;
        }

        .stat-item-large {
            text-align: center;
        }

        .stat-number-large {
            font-size: 3rem;
            font-weight: 800;
            background: var(--brand-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 0.5rem;
            font-family: 'JetBrains Mono', monospace;
        }

        .stat-label-large {
            color: var(--gray-light);
            font-size: 1rem;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            font-weight: 500;
        }

        .section-header {
            text-align: center;
            margin-bottom: 2rem;
        }

        .section-title {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 1rem;
            background: var(--brand-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .section-subtitle {
            font-size: 1.1rem;
            color: var(--gray-light);
            max-width: 600px;
            margin: 0 auto;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .container {
                padding: 0 1rem;
            }

            .hero-title {
                font-size: 2.5rem;
            }

            .nav {
                display: none;
            }

            .nav-stats {
                flex-direction: column;
                gap: 0.5rem;
            }

            .main-grid {
                grid-template-columns: 1fr;
            }

            .analysis-controls {
                grid-template-columns: 1fr;
            }

            .results-header {
                flex-direction: column;
                align-items: flex-start;
            }

            .features-grid {
                grid-template-columns: 1fr;
            }

            .stats-grid {
                grid-template-columns: 1fr 1fr;
            }

            .hero-actions {
                flex-direction: column;
                align-items: center;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="container">
            <div class="header-content">
                <a href="#" class="logo">
                    <div class="logo-icon">&lt;/&gt;</div>
                    <span class="logo-text">CodeGuard</span>
                </a>
                
                <nav class="nav">
                    <a href="#analyzer" class="nav-item">Code Scanner</a>
                    <a href="#features" class="nav-item">Security Analysis</a>
                    <a href="#stats" class="nav-item">Platform Stats</a>
                </nav>

                <div class="nav-stats">
                    <div class="stat-item">
                        <span class="stat-number" id="headerLanguages">9</span>
                        <span class="stat-label">Languages</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-number" id="headerPatterns">75+</span>
                        <span class="stat-label">Patterns</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-number" id="headerScanned">0</span>
                        <span class="stat-label">Scanned</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <main>
        <div class="container">
            <!-- Hero Section -->
            <section class="hero">
                <div class="hero-badge">
                    <span class="bug-icon">🐞</span>
                    Advanced static code security analysis platform
                </div>
                <h1 class="hero-title">Secure Code Analysis Platform</h1>
                <p class="hero-subtitle">
                    Static code analysis with real-time vulnerability detection, intelligent pattern matching, 
                    and comprehensive security analysis for secure software development.
                </p>
                <div class="hero-actions">
                    <a href="#analyzer" class="btn btn-primary">
                        <span>🚀</span>
                        Start Analysis
                    </a>
                    <a href="#features" class="btn btn-secondary">
                        <span>🔧</span>
                        Explore Features
                    </a>
                </div>
            </section>

            <!-- Main Grid -->
            <div class="main-grid">
                <!-- Analysis Platform -->
                <section id="analyzer" class="analysis-platform">
                    <div class="platform-content">
                        <div class="platform-header">
                            <h2 class="platform-title">Static Code Analysis Engine</h2>
                            <p class="platform-subtitle">
                                Upload your source code and execute comprehensive security analysis with 
                                automated vulnerability detection and detailed code security reporting.
                            </p>
                        </div>

                        <div class="upload-zone" id="uploadZone" onclick="document.getElementById('codeFile').click()">
                            <div class="upload-content">
                                <span class="upload-icon">&lt;/&gt;</span>
                                <div class="upload-text">Drop code files here or click to browse</div>
                                <div class="upload-subtext">Supports: Python, JavaScript, TypeScript, PHP, Java, C/C++, HTML, Ruby, Go</div>
                            </div>
                        </div>

                        <input type="file" id="codeFile" style="display: none;" multiple 
                               accept=".py,.js,.jsx,.ts,.tsx,.java,.c,.cpp,.h,.hpp,.php,.rb,.go,.html,.htm,.css">

                        <div class="analysis-controls">
                            <select class="language-select" id="languageSelect">
                                <option value="auto">Auto-detect Language</option>
                                <option value="python">Python</option>
                                <option value="javascript">JavaScript</option>
                                <option value="typescript">TypeScript</option>
                                <option value="php">PHP</option>
                                <option value="java">Java</option>
                                <option value="cpp">C/C++</option>
                                <option value="html">HTML/CSS</option>
                                <option value="ruby">Ruby</option>
                                <option value="go">Go</option>
                            </select>

                            <button class="analyze-btn" id="analyzeBtn" onclick="executeAnalysis()" disabled>
                                <span>🔍</span>
                                Execute Analysis
                            </button>

                            <button class="export-btn" id="exportBtn" onclick="showExportOptions()" style="display: none;">
                                <span>📤</span>
                                Export
                            </button>
                        </div>

                        <div class="progress-section" id="progressSection">
                            <div class="progress-bar">
                                <div class="progress-fill" id="progressFill"></div>
                            </div>
                            <div class="progress-text" id="progressText">Initializing security analysis...</div>
                        </div>

                        <div class="results-panel" id="resultsPanel">
                            <div class="results-header">
                                <h3 class="results-title">🚨 Security Analysis Results</h3>
                                <div class="severity-filter">
                                    <button class="filter-btn active" data-severity="all">All</button>
                                    <button class="filter-btn" data-severity="critical">Critical</button>
                                    <button class="filter-btn" data-severity="warning">High</button>
                                    <button class="filter-btn" data-severity="info">Medium</button>
                                    <button class="filter-btn" data-severity="low">Low</button>
                                </div>
                            </div>
                            
                            <div class="results-summary" id="resultsSummary">
                                <!-- Summary badges will be populated here -->
                            </div>
                            
                            <div id="vulnerabilityList">
                                <!-- Vulnerability items will be populated here -->
                            </div>
                        </div>

                        <div class="export-section" id="exportSection">
                            <h3 style="margin-bottom: 1rem; color: var(--primary);">📤 Export Intelligence Report</h3>
                            <div class="export-buttons">
                                <button class="btn btn-primary" onclick="exportResults('pdf')">
                                    <span>📄</span>
                                    Export PDF
                                </button>
                                <button class="btn btn-primary" onclick="exportResults('json')">
                                    <span>📊</span>
                                    Export JSON
                                </button>
                                <button class="btn btn-primary" onclick="exportResults('csv')">
                                    <span>📋</span>
                                    Export CSV
                                </button>
                                <button class="btn btn-secondary" onclick="resetAnalysis()">
                                    <span>🔄</span>
                                    New Analysis
                                </button>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Sidebar -->
                <div class="sidebar">
                    <!-- Live Statistics -->
                    <div class="sidebar-card">
                        <h3>📊 Session Analytics</h3>
                        <div class="live-stats">
                            <div class="live-stat">
                                <div class="live-stat-value" id="filesScanned">0</div>
                                <div class="live-stat-label">Files Scanned</div>
                            </div>
                            <div class="live-stat">
                                <div class="live-stat-value" id="issuesFound">0</div>
                                <div class="live-stat-label">Issues Found</div>
                            </div>
                            <div class="live-stat">
                                <div class="live-stat-value" id="scanTime">0s</div>
                                <div class="live-stat-label">Scan Time</div>
                            </div>
                            <div class="live-stat">
                                <div class="live-stat-value" id="riskScore">0</div>
                                <div class="live-stat-label">Risk Score</div>
                            </div>
                        </div>
                        <div style="margin-top: 0.5rem; font-size: 0.7rem; color: var(--gray-light); text-align: center;">
                            ⓘ Statistics reset on page refresh
                        </div>
                        <button onclick="clearAllStatistics()" 
                                style="margin-top: 1rem; padding: 0.5rem 1rem; background: rgba(239, 68, 68, 0.1); 
                                       border: 1px solid rgba(239, 68, 68, 0.3); color: #ef4444; border-radius: 6px; 
                                       cursor: pointer; font-size: 0.8rem; width: 100%; transition: all 0.3s ease;"
                                onmouseover="this.style.background='rgba(239, 68, 68, 0.2)'"
                                onmouseout="this.style.background='rgba(239, 68, 68, 0.1)'"
                                title="Statistics reset on page refresh">
                            🗑️ Clear Session Stats
                        </button>
                    </div>

                    <!-- Supported Languages -->
                    <div class="sidebar-card">
                        <h3>🌐 Language Support</h3>
                        <div class="language-list">
                            <span class="language-tag">Python</span>
                            <span class="language-tag">JavaScript</span>
                            <span class="language-tag">TypeScript</span>
                            <span class="language-tag">C/C++</span>
                            <span class="language-tag">Java</span>
                            <span class="language-tag">PHP</span>
                            <span class="language-tag">Ruby</span>
                            <span class="language-tag">Go</span>
                            <span class="language-tag">HTML</span>
                        </div>
                    </div>

                    <!-- Detection Capabilities -->
                    <div class="sidebar-card">
                        <h3>🔍 Code Security Analysis</h3>
                        <ul style="list-style: none; color: var(--gray-light); font-size: 0.9rem; line-height: 1.8;">
                            <li>🚨 Code injection detection</li>
                            <li>🔑 Hardcoded credentials</li>
                            <li>⚡ Command injection analysis</li>
                            <li>🌐 XSS vulnerability patterns</li>
                            <li>🗄️ SQL injection detection</li>
                            <li>🔒 Cryptographic weaknesses</li>
                            <li>💾 Memory safety analysis</li>
                            <li>🛡️ Authentication vulnerabilities</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Features Section -->
            <section id="features" class="features-section">
                <div class="section-header">
                    <h2 class="section-title">Code Security Analysis Toolkit</h2>
                    <p class="section-subtitle">
                        Comprehensive static code analysis powered by advanced pattern matching, 
                        vulnerability detection algorithms, and secure coding best practices databases.
                    </p>
                </div>

                <div class="features-grid">
                    <div class="feature-card">
                        <div class="feature-icon">🔥</div>
                        <h3 class="feature-title">Injection Vulnerability Scanner</h3>
                        <p class="feature-description">
                            Advanced detection for code injection, SQL injection, and command injection 
                            using sophisticated pattern matching and data flow analysis.
                        </p>
                    </div>

                    <div class="feature-card">
                        <div class="feature-icon">🔐</div>
                        <h3 class="feature-title">Credential Exposure Detection</h3>
                        <p class="feature-description">
                            Intelligent scanning for hardcoded passwords, API keys, certificates, 
                            and sensitive configuration data within your codebase.
                        </p>
                    </div>

                    <div class="feature-card">
                        <div class="feature-icon">🌐</div>
                        <h3 class="feature-title">Cross-Site Scripting Engine</h3>
                        <p class="feature-description">
                            Comprehensive XSS detection including DOM-based, reflected, and stored 
                            XSS patterns with context-aware analysis.
                        </p>
                    </div>

                    <div class="feature-card">
                        <div class="feature-icon">💾</div>
                        <h3 class="feature-title">Memory Safety Analysis</h3>
                        <p class="feature-description">
                            Advanced static analysis for C/C++ applications to identify buffer overflows, 
                            memory leaks, and use-after-free vulnerabilities.
                        </p>
                    </div>

                    <div class="feature-card">
                        <div class="feature-icon">⚡</div>
                        <h3 class="feature-title">Multi-Language Framework</h3>
                        <p class="feature-description">
                            Universal analysis supporting 9+ programming languages with language-specific 
                            security rules and vulnerability databases.
                        </p>
                    </div>

                    <div class="feature-card">
                        <div class="feature-icon">📊</div>
                        <h3 class="feature-title">Intelligence Reporting</h3>
                        <p class="feature-description">
                            Automated security reports with detailed vulnerability analysis, 
                            risk assessment, and actionable remediation recommendations.
                        </p>
                    </div>
                </div>
            </section>

            <!-- Statistics Section -->
            <section id="stats" class="stats-section">
                <div class="section-header">
                    <h2 class="section-title">Code Analysis Platform Metrics</h2>
                    <p class="section-subtitle">
                        Trusted by development teams worldwide for comprehensive code vulnerability detection and static security analysis.
                    </p>
                </div>

                <div class="stats-grid">
                    <div class="stat-item-large">
                        <div class="stat-number-large">9+</div>
                        <div class="stat-label-large">Languages</div>
                    </div>
                    <div class="stat-item-large">
                        <div class="stat-number-large">75+</div>
                        <div class="stat-label-large">Patterns</div>
                    </div>
                    <div class="stat-item-large">
                        <div class="stat-number-large">0.8s</div>
                        <div class="stat-label-large">Avg Scan</div>
                    </div>
                    <div class="stat-item-large">
                        <div class="stat-number-large">95%</div>
                        <div class="stat-label-large">Accuracy</div>
                    </div>
                </div>
            </section>
        </div>
    </main>

    <!-- PDF Generation Library -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    
    <script>
        // Global variables with session storage (resets on page refresh)
        let selectedFiles = [];
        let scanResults = [];
        let totalScanned = 0;
        let totalIssuesFound = 0;
        let totalScanTime = 0;

        // Initialize application
        function initializeApp() {
            updateHeaderStats();
            updateLiveStats();
        }

        // Initialize particle system
        function createParticle() {
            const particle = document.createElement('div');
            particle.className = 'particle';
            
            const types = ['primary', 'secondary', 'accent'];
            const type = types[Math.floor(Math.random() * types.length)];
            particle.classList.add(type);
            
            particle.style.left = Math.random() * 100 + 'vw';
            particle.style.width = particle.style.height = Math.random() * 6 + 2 + 'px';
            
            document.body.appendChild(particle);
            
            setTimeout(() => {
                particle.remove();
            }, 8000);
        }

        // Create particles periodically
        setInterval(createParticle, 2000);

        // File handling
        const codeFile = document.getElementById('codeFile');
        const uploadZone = document.getElementById('uploadZone');
        const analyzeBtn = document.getElementById('analyzeBtn');
        const exportBtn = document.getElementById('exportBtn');
        const progressSection = document.getElementById('progressSection');
        const resultsPanel = document.getElementById('resultsPanel');
        const exportSection = document.getElementById('exportSection');

        // File upload handling
        codeFile.addEventListener('change', handleFileSelect);

        uploadZone.addEventListener('dragover', (e) => {
            e.preventDefault();
            uploadZone.style.borderColor = 'var(--primary)';
            uploadZone.style.background = 'rgba(0, 217, 255, 0.1)';
        });

        uploadZone.addEventListener('dragleave', (e) => {
            e.preventDefault();
            resetUploadZone();
        });

        uploadZone.addEventListener('drop', (e) => {
            e.preventDefault();
            resetUploadZone();
            handleFileSelect({ target: { files: e.dataTransfer.files } });
        });

        function handleFileSelect(event) {
            selectedFiles = Array.from(event.target.files);
            updateUploadDisplay();
            analyzeBtn.disabled = selectedFiles.length === 0;
            
            if (selectedFiles.length > 0) {
                detectLanguage(selectedFiles[0].name);
            }
        }

        function updateUploadDisplay() {
            if (selectedFiles.length > 0) {
                const totalSize = selectedFiles.reduce((sum, file) => sum + file.size, 0);
                const sizeKB = (totalSize / 1024).toFixed(1);
                
                uploadZone.classList.add('active');
                uploadZone.innerHTML = `
                    <div class="upload-content">
                        <span class="upload-icon" style="color: var(--secondary);">&lt;/&gt;</span>
                        <div class="upload-text">${selectedFiles.length} file(s) ready for analysis</div>
                        <div class="upload-subtext">${sizeKB} KB • ${selectedFiles.map(f => f.name).join(', ')}</div>
                    </div>
                `;
            } else {
                resetUploadZone();
            }
        }

        function resetUploadZone() {
            uploadZone.style.borderColor = 'rgba(0, 217, 255, 0.4)';
            uploadZone.style.background = 'rgba(10, 10, 35, 0.4)';
            uploadZone.classList.remove('active');
            uploadZone.innerHTML = `
                <div class="upload-content">
                    <span class="upload-icon">&lt;/&gt;</span>
                    <div class="upload-text">Drop code files here or click to browse</div>
                    <div class="upload-subtext">Supports: Python, JavaScript, TypeScript, PHP, Java, C/C++, HTML, Ruby, Go</div>
                </div>
            `;
        }

        function detectLanguage(filename) {
            const ext = filename.split('.').pop().toLowerCase();
            const langMap = {
                'py': 'python', 'js': 'javascript', 'jsx': 'javascript',
                'ts': 'typescript', 'tsx': 'typescript', 'php': 'php',
                'java': 'java', 'cpp': 'cpp', 'c': 'cpp', 'h': 'cpp',
                'html': 'html', 'htm': 'html', 'css': 'html',
                'rb': 'ruby', 'go': 'go'
            };
            
            const select = document.getElementById('languageSelect');
            if (langMap[ext]) {
                select.value = langMap[ext];
            }
        }

        // Analysis execution
        function executeAnalysis() {
            if (selectedFiles.length === 0) return;

            // Show progress
            progressSection.classList.add('active');
            resultsPanel.classList.remove('active');
            exportSection.classList.remove('active');
            analyzeBtn.disabled = true;
            exportBtn.style.display = 'none';

            // Animate progress
            let progress = 0;
            const progressFill = document.getElementById('progressFill');
            const progressText = document.getElementById('progressText');
            
            const messages = [
                'Initializing intelligence analysis...',
                'Parsing source code with AI...',
                'Analyzing threat intelligence patterns...',
                'Cross-referencing security intelligence...',
                'Generating threat assessment...',
                'Compiling intelligence report...'
            ];

            const progressInterval = setInterval(() => {
                progress += Math.random() * 15 + 5;
                if (progress >= 100) {
                    progress = 100;
                    clearInterval(progressInterval);
                    setTimeout(() => {
                        progressSection.classList.remove('active');
                        performActualAnalysis();
                    }, 500);
                }
                
                progressFill.style.width = progress + '%';
                const messageIndex = Math.floor((progress / 100) * messages.length);
                progressText.textContent = messages[Math.min(messageIndex, messages.length - 1)];
            }, 200);
        }

        function performActualAnalysis() {
            // Try real API first
            const formData = new FormData();
            selectedFiles.forEach(file => {
                formData.append('file', file);
            });

            fetch('http://localhost:5000/api/scan', {
                method: 'POST',
                body: formData
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    scanResults = Array.isArray(data.issues) ? data.issues : [data];
                } else {
                    throw new Error('API returned error');
                }
                showResults();
            })
            .catch(error => {
                console.log('API not available, showing demo results');
                scanResults = generateDemoResults();
                showResults();
            });
        }

        function generateDemoResults() {
            const demoIssues = [
                {
                    line: 23,
                    code: 'eval(user_input)',
                    issue: 'Code Injection Vulnerability',
                    severity: 'Critical',
                    description: 'Dynamic code execution detected using eval() function. This allows arbitrary code execution.'
                },
                {
                    line: 8,
                    code: 'password = "admin123"',
                    issue: 'Hardcoded Credential',
                    severity: 'High',
                    description: 'Hardcoded password found in source code. This exposes sensitive authentication data.'
                },
                {
                    line: 45,
                    code: 'query = f"SELECT * FROM users WHERE id = {user_id}"',
                    issue: 'SQL Injection Risk',
                    severity: 'High',
                    description: 'SQL query vulnerable to injection attacks due to string concatenation.'
                },
                {
                    line: 12,
                    code: 'innerHTML = userContent',
                    issue: 'Cross-Site Scripting',
                    severity: 'Medium',
                    description: 'Potential XSS vulnerability through direct DOM manipulation.'
                }
            ];
            
            return demoIssues.slice(0, Math.floor(Math.random() * 4) + 1);
        }

        function showResults() {
            // Update statistics
            updateStats();
            
            // Show results
            resultsPanel.classList.add('active');
            exportBtn.style.display = 'block';
            exportSection.classList.add('active');
            analyzeBtn.disabled = false;
            
            displayResults(scanResults);
        }

        function updateStats() {
            // Update session statistics (in-memory only)
            totalScanned += selectedFiles.length;
            totalIssuesFound += scanResults.length;
            totalScanTime += 1.2; // Average scan time
            
            // Update displays
            updateHeaderStats();
            updateLiveStats();
        }

        function updateHeaderStats() {
            document.getElementById('headerScanned').textContent = totalScanned;
        }

        function updateLiveStats() {
            document.getElementById('filesScanned').textContent = totalScanned;
            document.getElementById('issuesFound').textContent = scanResults.length || totalIssuesFound;
            document.getElementById('scanTime').textContent = '1.2s';
            document.getElementById('riskScore').textContent = calculateRiskScore();
        }

        function calculateRiskScore() {
            if (scanResults.length === 0) {
                // If no current results, calculate from session totals
                const avgIssuesPerScan = totalScanned > 0 ? totalIssuesFound / totalScanned : 0;
                return avgIssuesPerScan > 0 ? Math.min(avgIssuesPerScan * 2, 10).toFixed(1) : '0';
            }
            
            let score = 0;
            scanResults.forEach(issue => {
                switch(issue.severity.toLowerCase()) {
                    case 'critical': score += 10; break;
                    case 'high': score += 7; break;
                    case 'medium': score += 4; break;
                    case 'low': score += 1; break;
                }
            });
            
            return Math.min(score, 10).toFixed(1);
        }

        function displayResults(results) {
            // Update summary
            const critical = results.filter(r => ['Critical', 'High'].includes(r.severity)).length;
            const warning = results.filter(r => r.severity === 'Medium').length;
            const info = results.filter(r => ['Low', 'Info'].includes(r.severity)).length;

            document.getElementById('resultsSummary').innerHTML = `
                <div class="summary-badge summary-critical">
                    <span>🔥</span> ${critical} Critical
                </div>
                <div class="summary-badge summary-warning">
                    <span>⚠️</span> ${warning} Warning
                </div>
                <div class="summary-badge summary-info">
                    <span>💡</span> ${info} Info
                </div>
            `;

            // Display vulnerabilities
            const vulnerabilityList = document.getElementById('vulnerabilityList');
            vulnerabilityList.innerHTML = results.map(vuln => {
                const severityClass = getSeverityClass(vuln.severity);
                const severityIcon = getSeverityIcon(vuln.severity);
                
                return `
                    <div class="vulnerability-item ${severityClass}">
                        <div class="vuln-header">
                            <div class="vuln-title-section">
                                <span class="vuln-icon">${severityIcon}</span>
                                <span class="vuln-title">${vuln.issue}</span>
                            </div>
                            <span class="vuln-severity severity-${severityClass}">${vuln.severity}</span>
                        </div>
                        <div class="vuln-location">Line ${vuln.line} • ${selectedFiles[0]?.name || 'source code'}</div>
                        <div class="vuln-description">${vuln.description || 'Security vulnerability detected'}</div>
                        <div class="vuln-code" data-language="python">
                            <span class="vulnerable-code">${vuln.code}</span>
                        </div>
                        <div class="recommendation">
                            <div class="recommendation-title">
                                <span>💡</span> Recommendation
                            </div>
                            ${getRecommendation(vuln.issue)}
                        </div>
                    </div>
                `;
            }).join('');
        }

        function getSeverityClass(severity) {
            const map = {
                'Critical': 'critical',
                'High': 'critical', 
                'Medium': 'warning',
                'Low': 'info',
                'Info': 'info'
            };
            return map[severity] || 'info';
        }

        function getSeverityIcon(severity) {
            const map = {
                'Critical': '🔥',
                'High': '🔥',
                'Medium': '⚠️',
                'Low': '💡',
                'Info': '💡'
            };
            return map[severity] || '💡';
        }

        function getRecommendation(issue) {
            const recommendations = {
                'Code Injection Vulnerability': 'Replace eval() with safe JSON parsing methods like json.loads() or implement input validation.',
                'Hardcoded Credential': 'Use environment variables or secure configuration files to store sensitive data.',
                'SQL Injection Risk': 'Use parameterized queries or prepared statements to prevent SQL injection attacks.',
                'Cross-Site Scripting': 'Sanitize user input and use textContent instead of innerHTML for dynamic content.'
            };
            return recommendations[issue] || 'Review code for security best practices and implement proper input validation.';
        }

        // Filter functionality
        document.querySelectorAll('.filter-btn').forEach(btn => {
            btn.addEventListener('click', (e) => {
                document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
                e.target.classList.add('active');
                
                const severity = e.target.dataset.severity;
                filterResults(severity);
            });
        });

        function filterResults(severity) {
            let filtered = scanResults;
            if (severity !== 'all') {
                const severityMap = {
                    'critical': ['Critical', 'High'],
                    'warning': ['Medium'],
                    'info': ['Low', 'Info']
                };
                filtered = scanResults.filter(result => 
                    severityMap[severity]?.includes(result.severity)
                );
            }
            displayResults(filtered);
        }

        // Export functionality
        function showExportOptions() {
            exportSection.style.display = exportSection.style.display === 'none' ? 'block' : 'none';
        }

        function exportResults(format) {
            if (scanResults.length === 0) return;

            const timestamp = new Date().toISOString();
            const filename = `codeguard_security_report_${timestamp.split('T')[0]}`;
            
            if (format === 'pdf') {
                generatePDFReport(filename);
                return;
            }
            
            let content = '';
            
            if (format === 'json') {
                content = JSON.stringify({
                    timestamp,
                    platform: 'CodeGuard Intelligence Platform',
                    files_analyzed: selectedFiles.map(f => f.name),
                    total_issues: scanResults.length,
                    risk_score: calculateRiskScore(),
                    vulnerabilities: scanResults.map(vuln => ({
                        ...vuln,
                        recommendation: getRecommendation(vuln.issue)
                    }))
                }, null, 2);
            } else if (format === 'csv') {
                content = 'Issue Type,Severity,Line,Code,Description,Recommendation\n';
                scanResults.forEach(vuln => {
                    const rec = getRecommendation(vuln.issue).replace(/"/g, '""');
                    content += `"${vuln.issue}","${vuln.severity}",${vuln.line},"${vuln.code}","${vuln.description}","${rec}"\n`;
                });
            }
            
            const blob = new Blob([content], { 
                type: format === 'json' ? 'application/json' : 'text/csv' 
            });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `${filename}.${format}`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        function generatePDFReport(filename) {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            
            let yPosition = 30; // Start with proper margin from top
            const pageWidth = doc.internal.pageSize.width;
            const pageHeight = doc.internal.pageSize.height;
            const margin = 20;
            const contentWidth = pageWidth - (margin * 2);
            
            // Helper function to check if we need a new page
            function checkNewPage(nextHeight = 10) {
                if (yPosition + nextHeight > pageHeight - 40) { // More bottom margin
                    doc.addPage();
                    yPosition = 30; // Start lower on new pages
                    return true;
                }
                return false;
            }
            
            // Header with CodeGuard branding
            function addHeader() {
                // Background gradient effect (simulated with rectangles)
                doc.setFillColor(10, 10, 35);
                doc.rect(0, 0, pageWidth, 55, 'F'); // Slightly taller header
                
                // CodeGuard Logo (using code brackets instead of emoji)
                doc.setFontSize(20);
                doc.setTextColor(0, 217, 255);
                doc.setFont('courier', 'bold');
                doc.text('</>', margin, 28); // Moved down slightly
                
                doc.setFontSize(28);
                doc.setFont('helvetica', 'bold');
                doc.text('CodeGuard', margin + 20, 28); // Moved down slightly
                
                // Subtitle
                doc.setFontSize(12);
                doc.setTextColor(148, 163, 184);
                doc.text('Secure coding for the better tech', margin + 20, 38); // Moved down slightly
                
                // Date and time
                const now = new Date();
                const dateStr = now.toLocaleDateString('en-US', { 
                    year: 'numeric', month: 'long', day: 'numeric',
                    hour: '2-digit', minute: '2-digit'
                });
                doc.setFontSize(10);
                doc.setTextColor(100, 100, 100);
                doc.text(`Generated: ${dateStr}`, pageWidth - margin - 60, 28); // Moved down slightly
                
                // Separator line
                doc.setDrawColor(0, 217, 255);
                doc.setLineWidth(0.5);
                doc.line(margin, 48, pageWidth - margin, 48); // Moved down slightly
                
                return 65; // Return more space for content
            }
            
            // Report Title and Summary
            yPosition = addHeader();
            yPosition += 10; // Add more space after header
            
            doc.setFontSize(22);
            doc.setTextColor(0, 0, 0);
            doc.setFont('helvetica', 'bold');
            doc.text('Code Security Analysis Report', margin, yPosition);
            yPosition += 20; // More space after title
            
            // Executive Summary Box
            doc.setFillColor(240, 248, 255);
            doc.setDrawColor(0, 217, 255);
            doc.roundedRect(margin, yPosition, contentWidth, 35, 3, 3, 'FD');
            
            doc.setFontSize(14);
            doc.setTextColor(0, 0, 0);
            doc.setFont('helvetica', 'bold');
            doc.text('Executive Summary', margin + 10, yPosition + 12);
            
            doc.setFont('helvetica', 'normal');
            doc.setFontSize(11);
            
            const critical = scanResults.filter(r => ['Critical', 'High'].includes(r.severity)).length;
            const medium = scanResults.filter(r => r.severity === 'Medium').length;
            const low = scanResults.filter(r => ['Low', 'Info'].includes(r.severity)).length;
            const riskScore = calculateRiskScore();
            
            const summaryText = `Analysis of ${selectedFiles.length} file(s) revealed ${scanResults.length} security issues. ` +
                              `Risk Score: ${riskScore}/10 (${critical} Critical/High, ${medium} Medium, ${low} Low)`;
            
            const splitSummary = doc.splitTextToSize(summaryText, contentWidth - 20);
            doc.text(splitSummary, margin + 10, yPosition + 22);
            yPosition += 45;
            
            // Statistics Section
            checkNewPage(60);
            
            doc.setFontSize(16);
            doc.setFont('helvetica', 'bold');
            doc.setTextColor(0, 0, 0);
            doc.text('Analysis Statistics', margin, yPosition);
            yPosition += 12;
            
            // Statistics boxes
            const statBoxWidth = (contentWidth - 20) / 3;
            const statBoxHeight = 25;
            
            // Critical Issues Box
            doc.setFillColor(239, 68, 68, 0.1);
            doc.setDrawColor(239, 68, 68);
            doc.roundedRect(margin, yPosition, statBoxWidth, statBoxHeight, 2, 2, 'FD');
            
            doc.setFontSize(20);
            doc.setTextColor(239, 68, 68);
            doc.setFont('helvetica', 'bold');
            doc.text(critical.toString(), margin + statBoxWidth/2 - 5, yPosition + 12);
            
            doc.setFontSize(10);
            doc.setTextColor(100, 100, 100);
            doc.text('Critical/High', margin + statBoxWidth/2 - 15, yPosition + 20);
            
            // Medium Issues Box
            doc.setFillColor(245, 158, 11, 0.1);
            doc.setDrawColor(245, 158, 11);
            doc.roundedRect(margin + statBoxWidth + 10, yPosition, statBoxWidth, statBoxHeight, 2, 2, 'FD');
            
            doc.setFontSize(20);
            doc.setTextColor(245, 158, 11);
            doc.setFont('helvetica', 'bold');
            doc.text(medium.toString(), margin + statBoxWidth + 10 + statBoxWidth/2 - 5, yPosition + 12);
            
            doc.setFontSize(10);
            doc.setTextColor(100, 100, 100);
            doc.text('Medium', margin + statBoxWidth + 10 + statBoxWidth/2 - 10, yPosition + 20);
            
            // Low Issues Box
            doc.setFillColor(16, 185, 129, 0.1);
            doc.setDrawColor(16, 185, 129);
            doc.roundedRect(margin + (statBoxWidth + 10) * 2, yPosition, statBoxWidth, statBoxHeight, 2, 2, 'FD');
            
            doc.setFontSize(20);
            doc.setTextColor(16, 185, 129);
            doc.setFont('helvetica', 'bold');
            doc.text(low.toString(), margin + (statBoxWidth + 10) * 2 + statBoxWidth/2 - 5, yPosition + 12);
            
            doc.setFontSize(10);
            doc.setTextColor(100, 100, 100);
            doc.text('Low/Info', margin + (statBoxWidth + 10) * 2 + statBoxWidth/2 - 10, yPosition + 20);
            
            yPosition += 35;
            
            // File Analysis Details
            checkNewPage(30);
            
            doc.setFontSize(16);
            doc.setFont('helvetica', 'bold');
            doc.setTextColor(0, 0, 0);
            doc.text('Files Analyzed', margin, yPosition);
            yPosition += 12;
            
            selectedFiles.forEach((file, index) => {
                checkNewPage(8);
                doc.setFontSize(11);
                doc.setFont('helvetica', 'normal');
                doc.setTextColor(50, 50, 50);
                
                const fileSize = (file.size / 1024).toFixed(1);
                const fileInfo = `${index + 1}. ${file.name} (${fileSize} KB)`;
                doc.text(fileInfo, margin + 10, yPosition);
                yPosition += 6;
            });
            
            yPosition += 10;
            
            // Vulnerability Details
            if (scanResults.length > 0) {
                checkNewPage(30);
                
                doc.setFontSize(16);
                doc.setFont('helvetica', 'bold');
                doc.setTextColor(0, 0, 0);
                doc.text('Vulnerability Details', margin, yPosition);
                yPosition += 15;
                
                scanResults.forEach((vuln, index) => {
                    checkNewPage(50);
                    
                    // Vulnerability box
                    const vulnBoxHeight = 45;
                    let boxColor, textColor;
                    
                    switch(vuln.severity) {
                        case 'Critical':
                        case 'High':
                            boxColor = [254, 242, 242];
                            textColor = [239, 68, 68];
                            break;
                        case 'Medium':
                            boxColor = [255, 251, 235];
                            textColor = [245, 158, 11];
                            break;
                        default:
                            boxColor = [240, 253, 250];
                            textColor = [16, 185, 129];
                    }
                    
                    doc.setFillColor(...boxColor);
                    doc.setDrawColor(...textColor);
                    doc.roundedRect(margin, yPosition, contentWidth, vulnBoxHeight, 3, 3, 'FD');
                    
                    // Vulnerability title
                    doc.setFontSize(12);
                    doc.setFont('helvetica', 'bold');
                    doc.setTextColor(...textColor);
                    doc.text(`${index + 1}. ${vuln.issue}`, margin + 10, yPosition + 12);
                    
                    // Severity badge
                    doc.setFontSize(9);
                    doc.setTextColor(255, 255, 255);
                    doc.setFillColor(...textColor);
                    doc.roundedRect(pageWidth - margin - 40, yPosition + 5, 30, 8, 2, 2, 'F');
                    doc.text(vuln.severity.toUpperCase(), pageWidth - margin - 35, yPosition + 10);
                    
                    // Line number
                    doc.setFontSize(10);
                    doc.setTextColor(100, 100, 100);
                    doc.text(`Line ${vuln.line}`, margin + 10, yPosition + 20);
                    
                    // Code snippet
                    doc.setFont('courier', 'normal');
                    doc.setFontSize(9);
                    doc.setTextColor(0, 0, 0);
                    const codeText = doc.splitTextToSize(vuln.code, contentWidth - 40);
                    doc.text(codeText, margin + 10, yPosition + 28);
                    
                    // Description
                    doc.setFont('helvetica', 'normal');
                    doc.setFontSize(9);
                    doc.setTextColor(75, 85, 99);
                    const descText = doc.splitTextToSize(vuln.description || 'Security vulnerability detected', contentWidth - 20);
                    doc.text(descText, margin + 10, yPosition + 37);
                    
                    yPosition += vulnBoxHeight + 10;
                });
            }
            
            // Recommendations Section
            checkNewPage(40);
            
            doc.setFontSize(16);
            doc.setFont('helvetica', 'bold');
            doc.setTextColor(0, 0, 0);
            doc.text('Security Recommendations', margin, yPosition);
            yPosition += 15;
            
            const recommendations = [
                '1. Implement proper input validation and sanitization for all user inputs',
                '2. Use parameterized queries to prevent SQL injection attacks',
                '3. Store sensitive configuration data in environment variables',
                '4. Implement Content Security Policy (CSP) headers for web applications',
                '5. Regular security audits and penetration testing',
                '6. Keep all dependencies and frameworks up to date',
                '7. Implement proper error handling to avoid information disclosure'
            ];
            
            doc.setFontSize(11);
            doc.setFont('helvetica', 'normal');
            doc.setTextColor(50, 50, 50);
            
            recommendations.forEach(rec => {
                checkNewPage(8);
                const splitRec = doc.splitTextToSize(rec, contentWidth - 20);
                doc.text(splitRec, margin + 10, yPosition);
                yPosition += splitRec.length * 6 + 3;
            });
            
            // Footer
            function addFooter() {
                const footerY = pageHeight - 20;
                
                doc.setDrawColor(0, 217, 255);
                doc.setLineWidth(0.3);
                doc.line(margin, footerY - 5, pageWidth - margin, footerY - 5);
                
                doc.setFontSize(8);
                doc.setTextColor(100, 100, 100);
                doc.text('CodeGuard Intelligence Platform', margin, footerY);
                doc.text(`Page ${doc.internal.getCurrentPageInfo().pageNumber}`, pageWidth - margin - 20, footerY);
                
                doc.setTextColor(0, 217, 255);
                doc.text('Confidential Intelligence Report', pageWidth/2 - 35, footerY);
            }
            
            // Add footer to all pages
            const pageCount = doc.internal.getNumberOfPages();
            for (let i = 1; i <= pageCount; i++) {
                doc.setPage(i);
                addFooter();
            }
            
            // Save the PDF
            doc.save(`${filename}.pdf`);
        }

        function resetAnalysis() {
            selectedFiles = [];
            scanResults = [];
            codeFile.value = '';
            
            progressSection.classList.remove('active');
            resultsPanel.classList.remove('active');
            exportSection.classList.remove('active');
            
            analyzeBtn.disabled = true;
            exportBtn.style.display = 'none';
            
            resetUploadZone();
            updateLiveStats(); // Update live stats to show current session data
        }

        function clearAllStatistics() {
            // Clear session storage (in-memory only)
            totalScanned = 0;
            totalIssuesFound = 0;
            totalScanTime = 0;
            
            // Update displays
            updateHeaderStats();
            updateLiveStats();
        }

        // Smooth scrolling
        document.querySelectorAll('a[href^="#"]').forEach(link => {
            link.addEventListener('click', function(e) {
                e.preventDefault();
                const targetId = this.getAttribute('href').substring(1);
                const targetElement = document.getElementById(targetId);
                if (targetElement) {
                    targetElement.scrollIntoView({ 
                        behavior: 'smooth',
                        block: 'start'
                    });
                }
            });
        });

        // Initialize the application when DOM is loaded
        document.addEventListener('DOMContentLoaded', initializeApp);
    </script>
</body>
</html>
